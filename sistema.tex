\chapter{Sistema de resolución de conflictos}
En este capítulo se propondrá el marco teórico y el esquema aplicativo del sistema de resolución de conflictos a utilizar en el marco de MAPC. Es importante destacar que, si bien por limitaciones temporales nuestro equipo únicamente implementó coordinaciones implícitas entre las acciones de los agentes durante la competencia del año 2011, la idea de implementación de un sistema de coordinación más complejo y robusto fue parte de los planes desde el comienzo del trabajo.

\section{Información necesaria}
Después de estudiar el flujo de información y el contenido de la base de conocimiento de cada uno de nuestros agentes, sabemos que en cada turno un agente conoce su conjunto completo de creencias, deseos, y tiene al menos una intención persistente y bien determinada, al igual que \textit{al menos} una acción a realizar a futuro. Recordemos, además, que gracias al Servidor de Percepciones cada agente tiene una visión unificada del mundo y conoce los roles, posiciones y características físicas de sus compañeros de equipo.

Consideremos el agregado a la arquitectura mostrado; luego de esta nueva fase de comunicación, todos los agentes conocen la decisión tomada por sus compañeros de equipo, incluyendo tanto la intención más fuerte como la acción a realizar por cada uno de ellos.  Toda esta información, en conjunto, puede ser utilizada con el fin de re-analizar concretamente cuán potencialmente beneficiosa, peligrosa o perjudicial es la acción a realizar por el agente, y reconsiderar al respecto.

\section{Propuesta de coordinación}

Mostraremos ahora la primer posibilidad de coordinación propuesta; este sistema fue propuesto para ser utilizado durante la competencia MAPC 2011, y si bien no pudo ser presentado por falta de tiempo, existen algunas versiones en estado \textit{beta} ya implementadas.

Dado que el sistema provee suficiente flexibilidad como para permitir definir
distintas estrategias de resolución de acuerdo a la táctica utilizada en la fase
actual del juego, el primer paso es escribir diferentes órdenes de prioridad
acordes a dichas fases. Es decir, el sistema de resolución propuesto permite
modificar el comportamiento de los agentes de manera dinámica según el estado
del juego, en lugar de resolver los potenciales conflictos siempre del mismo
modo. Los órdenes de prioridad escritos pueden determinar, por ejemplo, tanto qué tipo de acciones tendrán predominancia sobre otras, como qué roles de agentes actuarán primero en caso de conflicto.

Una vez que contamos con los órdenes de prioridad, el agente utiliza todo el
conocimiento de las características físicas y las intenciones y acciones
inminentes de sus compañeros, y re-evalúa la propia. Es importante mencionar
que, en este esquema de coordinación, cuando un agente decide que realizar la
acción que había elegido deja de ser conveniente, pasa a actuar de manera
\textit{segura}, en el sentido de que realiza acciones que garantizan (o al
menos, maximizan las chances de) que no haya conflictos con otros agentes o
riesgo de p\'erdida de puntos. Se detallarán las potenciales acciones a realizar en \textit{modo seguro} en la sección siguiente, y más adelante analizaremos alternativas de acción que puedan dar aún más rédito.

\subsection{Clasificaci\'on de conflictos}
Existen diferentes tipos de conflicto que los agentes pueden encontrar al
momento de reconsiderar su decisi\'on respecto a la manera de actuar.

Resulta natural pensar, por ejemplo, que si dos o más agentes van a realizar una
misma acción con una intención idéntica (y que dicha acción/intención deba ser
realizada una única vez), entonces es un malgasto de recursos (energía) que
todos ellos la realicen. Un ejemplo de este caso ocurre cuando dos agentes
cualesquiera tienen como intención survey($X_{i}$), cuando dos exploradores
tienen como intención probear($X_{i}$), o cuando dos inspectores tienen como
intención inspect($X_{i}$), para el mismo \textit{i}. En cualquiera de estos
casos, resulta evidente que sólo uno de los agentes debería llevar a cabo la
acción. El criterio específico para decidir cuál de ellos la realiza puede ser
definido de muchas maneras; el propuesto para la competencia fue dejar que el
agente que pudiera efectivizar la intención en menor cantidad de turnos
realizara la acción, y en caso de empate, dejar que el que tuviera más energía
fuera el ganador. Si ambas condiciones resultaran en empate, el ganador se
determina por orden lexicográfico. Por lo tanto, en caso de que un agente
detectara que otro tiene la misma intención, y que dicho agente se encuentra en
una postura más favorable, y que no tiene sentido que la intención sea efectivizada por más de un agente, entonces pasa a actuar en \textit{modo seguro}.
Sin embargo, no todos los casos en los que dos o más agentes tengan exactamente
la misma intención resultan conflictivos: por ejemplo, dos saboteadores pueden
querer atacar de manera simultánea a un mismo enemigo. Esta situación da lugar a
la clasificación de todas las intenciones en dos tipos: \textit{cooperativas} y
\textit{excluyentes}.

Por otro lado, existen conflictos m\'as complejos para su detecci\'on y
resoluci\'on, como por ejemplo, que un agente dos agentes decidan moverse para
expandir una zona dominada, y que el movimiento sincronizada resulte en la
p\'erdida de la zona.

A continuaci\'on, analizaremos c\'omo se detectan y resuelven todos estos
conflictos.

\subsubsection{Deteccio\'on de conflictos}

Una vez finalizada la segunda fase de comunicaci\'on, cada agente considera las
intenciones y acciones a realizar de los dem\'as miembros del equipo en busca de
potenciales conflictos.

El primer y m\'as sencillo paso es verificar si otro agente tiene una
intenci\'on excluyente que coincida con la propia. Si ese es el caso, se
eval\'ua cu\'al de los dos agentes se encuentra en mejor estado para efectivizar
al intenci\'on (de acuerdo a, como se mencion\'o antes, la cantidad de turnos
que 
